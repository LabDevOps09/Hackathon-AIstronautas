import requests
import json
import os

# Function to store data in JSON
def store_data_json(data, file_name="/workspaces/Hackathon-AIstronautas/mars_rover_data.json"):
    try:
        with open(file_name, "w") as f:
            json.dump(data, f, indent=4)
        print(f"Data has been successfully stored in {file_name}")
    except Exception as e:
        print(f"Error while storing data in {file_name}: {e}")

# API Settings
API_KEY = "8HALnlv0Gc2ZyMFDLQmwYKFlTieI3pWmS3RmUDRv"   # Replace with your NASA API key
URL = "https://api.nasa.gov/mars-photos/api/v1/rovers/curiosity/photos"  # URL for Mars Rover photos

# Request parameters
params = {
    "earth_date": "2023-01-01",  # Replace with the desired date (format: YYYY-MM-DD)
    "api_key": API_KEY
}

try:
    # Make the request to the API
    response = requests.get(URL, params=params)
    response.raise_for_status()  # Raise an error if the request fails

    # Process the response data
    data = response.json()  # Convert the JSON to a dictionary
    
    # Check if 'photos' key is in the response data
    photos = data.get("photos", [])  # Access the list of photos

    if photos:
        print(f"Found {len(photos)} photos.")
        for photo in photos[:5]:  # Display up to 5 photos
            print(f"Photo taken by {photo['camera']['full_name']} on {photo['earth_date']}: {photo['img_src']}")
        
        # Store the data in the JSON file
        store_data_json(data)
    else:
        print("No photos available for this date.")

except requests.RequestException as e:
    print(f"Error while fetching data: {e}")
except json.JSONDecodeError:
    print("Error while decoding the response JSON.")




